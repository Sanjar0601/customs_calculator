import pycountry

# Полный маппинг официальных названий с Lex.uz в ISO Alpha-2 коды
MANUAL_MAPPING = {
	# --- СНГ и страны с режимом свободной торговли (Приложение 2) ---
	"Республика Беларусь": "BY",
	"Республика Грузия": "GE",
	"Республика Қазахстан": "KZ",  # В документе через "Қ"
	"Казахстан": "KZ",  # На всякий случай
	"Қыргызская Республика": "KG",  # В документе через "Қ"
	"Кыргызстан": "KG",  # На всякий случай
	"Республика Молдова": "MD",
	"Российская Федерация": "RU",
	"Туркменистан": "TM",
	"Украина": "UA",
	"Республика Таджикистан": "TJ",
	"Республика Азербайджан": "AZ",
	
	# --- Страны РНБ (Приложение 1) - Европа ---
	"Австрийская Республика": "AT",
	"Королевство Бельгия": "BE",
	"Республика Болгария": "BG",
	"Венгрия": "HU",
	"Федеративная Республика Германия": "DE",
	"Республика Греция": "GR",
	"Королевство Дания": "DK",
	"Ирландия": "IE",
	"Королевство Испания": "ES",
	"Республика Италия": "IT",
	"Республика Кипр": "CY",
	"Латвийская Республика": "LV",
	"Литовская Республика": "LT",
	"Республика Мальта": "MT",
	"Великое Герцогство Люксембург": "LU",
	"Королевство Нидерландов": "NL",
	"Португальская Республика": "PT",
	"Республика Польша": "PL",
	"Республика Словения": "SI",
	"Румыния": "RO",
	"Словацкая Республика": "SK",
	"Соединенное Королевство Великобритании и Северной Ирландии": "GB",
	"Финляндская Республика": "FI",
	"Французская Республика": "FR",
	"Республика Хорватия": "HR",
	"Чешская Республика": "CZ",
	"Швейцарская Конфедерация": "CH",
	"Королевство Швеция": "SE",
	"Эстонская Республика": "EE",
	
	# --- Страны РНБ (Приложение 1) - Азия и Восток ---
	"Исламская Республика Афганистан": "AF",
	"Народная Республика Бангладеш": "BD",
	"Социалистическая Республика Вьетнам": "VN",
	"Арабская Республика Египет": "EG",
	"Государство Израиль": "IL",
	"Республика Индия": "IN",
	"Республика Индонезия": "ID",
	"Иорданское Хашимитское Королевство": "JO",
	"Китайская Народная Республика": "CN",
	"Республика Корея": "KR",  # Южная Корея
	"Исламская Республика Пакистан": "PK",
	"Республика Сингапур": "SG",
	"Турецкая Республика": "TR",
	"Япония": "JP",
	"Королевство Саудовская Аравия": "SA",
	"Малайзия": "MY",
	
	# --- Страны РНБ (Приложение 1) - Америка ---
	"Соединенные Штаты Америки": "US",
	"Федеративная Республика Бразилия": "BR",
}


def get_iso_code_by_russian_name(name_ru: str) -> str:
	"""
	Находит ISO код (Alpha-2) по русскому названию.
	"""
	# 1. Очистка названия от мусора (*, пробелы)
	clean_name = name_ru.strip().replace("*", "")
	
	# 2. Проверка по нашему словарю
	if clean_name in MANUAL_MAPPING:
		return MANUAL_MAPPING[clean_name]
	
	# 3. Если вдруг не нашли в словаре, можно попробовать pycountry
	# (но словарь выше покрывает 100% твоего списка ошибок)
	try:
		# Попытка поиска, если название совпадет с официальным английским (маловероятно для русских названий)
		country = pycountry.countries.get(name=clean_name)
		if country:
			return country.alpha_2
	except LookupError:
		pass
	
	return None